
;
;TEST OF THE Z80 CTC ON THE EDM-80
;
;

CTC	EQU	84H
VIDEO	EQU	4000H


	ORG	6430H


START:	DI
	IM	2
	LD	A,IVECT/256
	LD	I,A
	LD	A,0B5H
	OUT	(CTC+2),A
	LD	A,0FFH
	OUT	(CTC+2),A
	LD	A,64H
	OUT	(CTC),A

	EI	
	RST	20H
	NOP
	NOP

;
;INTERRUPT HANDLER
;

IHANDLER:
	PUSH	AF
	LD	A,(VIDEO)
	LD	(VAR1),A
	INC	A
	LD	(VIDEO),A
	POP	AF
	EI
	RETI
	NOP
	NOP

VAR1:	DB	0

	ORG	6460H

IVECT	DW	IHANDLER		;CH #0
	DW	IHANDLER		;CH #1
	DW	IHANDLER		;CH #2
	DW	IHANDLER		;CH #3




	END
